<div class="bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden mx-auto max-w-6xl">
  <div class="px-4 py-3 bg-gray-50 border-b border-gray-200">
    <h2 class="text-lg font-semibold text-gray-900"><%= league.name %></h2>
  </div>

  <div class="overflow-x-auto">
    <table class="table-auto divide-y divide-gray-200 w-full border-b border-gray-200">
      <thead class="bg-gray-50">
        <tr>
          <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider sticky left-0 bg-gray-50 z-10 w-auto">
            Adversário
          </th>
          <th scope="col" class="px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-300">
            Casa
          </th>
          <th scope="col" class="px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-300">
            Fora
          </th>
          <th scope="col" class="px-3 py-2 text-center text-xs font-medium text-gray-500 uppercase tracking-wider border-l border-gray-300 border-r border-gray-300">
            Total
          </th>
        </tr>
        <tr class="bg-gray-100">
          <th scope="col" class="px-3 py-1 text-xs font-medium text-gray-600 sticky left-0 bg-gray-100 z-10"></th>
          <th scope="col" class="px-3 py-1 text-center text-xs font-medium text-gray-600 border-l border-gray-300">
            <div class="grid grid-cols-4 gap-1">
              <span class="text-xs">V</span>
              <span class="text-xs">E</span>
              <span class="text-xs">D</span>
              <span class="text-xs">J</span>
            </div>
          </th>
          <th scope="col" class="px-3 py-1 text-center text-xs font-medium text-gray-600 border-l border-gray-300">
            <div class="grid grid-cols-4 gap-1">
              <span class="text-xs">V</span>
              <span class="text-xs">E</span>
              <span class="text-xs">D</span>
              <span class="text-xs">J</span>
            </div>
          </th>
          <th scope="col" class="px-3 py-1 text-center text-xs font-medium text-gray-600 border-l border-gray-300 border-r border-gray-300">
            <div class="grid grid-cols-4 gap-1">
              <span class="text-xs">V</span>
              <span class="text-xs">E</span>
              <span class="text-xs">D</span>
              <span class="text-xs">J</span>
            </div>
          </th>
        </tr>
      </thead>
      <tbody class="bg-white divide-y divide-gray-200">
        <% if opponents.empty? %>
          <tr>
            <td colspan="4" class="px-3 py-3 text-center text-sm text-gray-500">
              Nenhum adversário encontrado
            </td>
          </tr>
        <% else %>
          <% 
            # Calculate grand totals
            grand_total_home = {
              wins: opponents.sum { |o| o[:home][:wins] },
              draws: opponents.sum { |o| o[:home][:draws] },
              losses: opponents.sum { |o| o[:home][:losses] },
              played: opponents.sum { |o| o[:home][:played] }
            }
            grand_total_away = {
              wins: opponents.sum { |o| o[:away][:wins] },
              draws: opponents.sum { |o| o[:away][:draws] },
              losses: opponents.sum { |o| o[:away][:losses] },
              played: opponents.sum { |o| o[:away][:played] }
            }
            grand_total_all = {
              wins: opponents.sum { |o| o[:total][:wins] },
              draws: opponents.sum { |o| o[:total][:draws] },
              losses: opponents.sum { |o| o[:total][:losses] },
              played: opponents.sum { |o| o[:total][:played] }
            }
          %>
          <% opponents.each do |opponent_stat| %>
            <tr class="hover:bg-gray-50 group">
              <td class="px-3 py-2 whitespace-nowrap sticky left-0 bg-white group-hover:bg-gray-50 z-10 w-auto">
                <div class="flex items-center gap-2">
                  <% if opponent_stat[:opponent].logo.present? %>
                    <img src="<%= opponent_stat[:opponent].logo %>" alt="<%= opponent_stat[:opponent].name %>" class="w-5 h-5 object-contain flex-shrink-0">
                  <% else %>
                    <div class="w-5 h-5 bg-gray-200 rounded-full flex items-center justify-center flex-shrink-0">
                      <span class="text-gray-400 text-xs font-semibold"><%= opponent_stat[:opponent].name[0..1].upcase %></span>
                    </div>
                  <% end %>
                  <span class="text-sm font-medium text-gray-900"><%= opponent_stat[:opponent].name %></span>
                </div>
              </td>
              <td class="px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-l border-gray-200">
                <div class="grid grid-cols-4 gap-1">
                  <span class="text-emerald-600 font-semibold"><%= opponent_stat[:home][:wins] %></span>
                  <span class="text-yellow-600 font-semibold"><%= opponent_stat[:home][:draws] %></span>
                  <span class="text-red-600 font-semibold"><%= opponent_stat[:home][:losses] %></span>
                  <span><%= opponent_stat[:home][:played] %></span>
                </div>
              </td>
              <td class="px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-l border-gray-200">
                <div class="grid grid-cols-4 gap-1">
                  <span class="text-emerald-600 font-semibold"><%= opponent_stat[:away][:wins] %></span>
                  <span class="text-yellow-600 font-semibold"><%= opponent_stat[:away][:draws] %></span>
                  <span class="text-red-600 font-semibold"><%= opponent_stat[:away][:losses] %></span>
                  <span><%= opponent_stat[:away][:played] %></span>
                </div>
              </td>
              <td class="px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-l border-gray-200 border-r border-gray-200">
                <div class="grid grid-cols-4 gap-1">
                  <span class="text-emerald-600 font-bold"><%= opponent_stat[:total][:wins] %></span>
                  <span class="text-yellow-600 font-bold"><%= opponent_stat[:total][:draws] %></span>
                  <span class="text-red-600 font-bold"><%= opponent_stat[:total][:losses] %></span>
                  <span class="font-semibold"><%= opponent_stat[:total][:played] %></span>
                </div>
              </td>
            </tr>
          <% end %>
          <!-- Grand Total Row -->
          <tr class="bg-gray-100 border-t-2 border-gray-300 font-bold">
            <td class="px-3 py-2 whitespace-nowrap sticky left-0 bg-gray-100 z-10 w-auto">
              <span class="text-sm font-bold text-gray-900">Total</span>
            </td>
            <td class="px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-l border-gray-300">
              <div class="grid grid-cols-4 gap-1">
                <span class="text-emerald-600 font-bold"><%= grand_total_home[:wins] %></span>
                <span class="text-yellow-600 font-bold"><%= grand_total_home[:draws] %></span>
                <span class="text-red-600 font-bold"><%= grand_total_home[:losses] %></span>
                <span class="font-bold"><%= grand_total_home[:played] %></span>
              </div>
            </td>
            <td class="px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-l border-gray-300">
              <div class="grid grid-cols-4 gap-1">
                <span class="text-emerald-600 font-bold"><%= grand_total_away[:wins] %></span>
                <span class="text-yellow-600 font-bold"><%= grand_total_away[:draws] %></span>
                <span class="text-red-600 font-bold"><%= grand_total_away[:losses] %></span>
                <span class="font-bold"><%= grand_total_away[:played] %></span>
              </div>
            </td>
            <td class="px-3 py-2 whitespace-nowrap text-center text-sm text-gray-900 border-l border-gray-300 border-r border-gray-300">
              <div class="grid grid-cols-4 gap-1">
                <span class="text-emerald-600 font-bold"><%= grand_total_all[:wins] %></span>
                <span class="text-yellow-600 font-bold"><%= grand_total_all[:draws] %></span>
                <span class="text-red-600 font-bold"><%= grand_total_all[:losses] %></span>
                <span class="font-bold"><%= grand_total_all[:played] %></span>
              </div>
            </td>
          </tr>
        <% end %>
      </tbody>
    </table>
  </div>
</div>
